<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Swift3 新特性  | Kenny 肉桂的主页</title>
  <meta name="author" content="桂庆">
  
  <meta name="description" content="Kenny 肉桂的主页 记录自己的进步">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Swift3 新特性 "/>
  <meta property="og:site_name" content="Kenny 肉桂的主页"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Kenny 肉桂的主页" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Kenny 肉桂的主页</a></h1>
  <h2><a href="/">记录自己的进步</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="/about">关于我</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-06-15T06:51:18.000Z"><a href="/2016/06/15/Swift/Swift3-新特性/">2016-06-15</a></time>
      
      
  
    <h1 class="title">Swift3 新特性 </h1>
  

    </header>
    <div class="entry">
      
        <p>看了一下刚出的 Session 406,简单记录一下关于 Swift3.0相比2.2的改动. 能力有限,若有谬误,欢迎指正 .</p>
<h3 id="简化的_API">简化的 API</h3><ul>
<li>优化将方法名切分,将操作中的动词提取,作为方法名.将其余部分作为参数名.</li>
<li>在不引起歧义的情况下,去掉了重复性的名词.</li>
</ul>
<p>Swift 2.2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var array:Array = [1,2]&#10;&#10;array.appendContentsOf([2,3,4])&#10;array.insert(1, atIndex: 0)&#10;&#10;var url = NSURL(string: &#34;randomLoacation&#34;)!&#10;&#10;if url.fileURL &#123;&#125;&#10;var x = url.URLByAppendingPathComponent(&#34;file.txt&#34;)</span><br></pre></td></tr></table></figure>
<p>Swift 3.0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//Swift.Array&#10;var array:Array = [1,2]&#10;&#10;array.append(contentsOf: [2,3,4])&#10;array.insert(1, at: 0) //index&#27809;&#26377;&#20160;&#20040;&#29305;&#23450;&#20449;&#24687;,&#21482;&#26159;&#37325;&#22797;&#10;&#10;//Foudation.NSURL&#10;var url = NSURL(string: &#34;randomLoacation&#34;)!&#10;if url.isFileURL &#123;&#125; //&#24847;&#24605;&#26356;&#26126;&#30830;&#10;var x = url.appendingPathComponent(&#34;file.txt&#34;)</span><br></pre></td></tr></table></figure>
<h3 id="一致的函数参数标签">一致的函数参数标签</h3><p>原来2.2中, 第一个参数标签可以省略.类似这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;func myFunction(a: Int , b: Int , c: Int)&#123;&#10;&#10;&#125;&#10;&#10;myFunction(42, b: 57, c: 39)</span><br></pre></td></tr></table></figure>
<p>在 3.0 中,上面的用法会报错. 需要显式写出标签,类似这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;func myFunction(a: Int , b: Int , c: Int)&#123;&#10;    &#10;&#125;&#10;&#10;myFunction(a: 10, b: 10, c: 10)</span><br></pre></td></tr></table></figure>
<p>当然,如果实在不想写,可以在声明的时候使用 <code>_</code> .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;func myFunction(_ a: Int , b: Int , c: Int)&#123;&#10;    &#10;&#125;&#10;&#10;myFunction(10, b: 10, c: 10)</span><br></pre></td></tr></table></figure>
<h3 id="移动_Where_语句到函数声明的结尾">移动 Where 语句到函数声明的结尾</h3><p>在 Swift2.2中,泛型约束语句<code>Where</code>需要放到泛型的<code>&lt;&gt;</code>中.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func anyCommon&#60;T: SequenceType, U: SequenceType&#10;    where T.Generator.Element : Equatable,&#10;    T.Generator.Element == U.Generator.Element&#62;(lhs: T, rhs: U) -&#62; Bool&#123;&#10;    print(&#34;here&#34;)&#10;    return true;&#10;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>在 Swift3.0中,将其提取到声明之后:<br>代码是参考的 Session 中的代码,但是本人用 Xcode8.0的 Playground 报错.但是主旨不会错,就是将<code>Where</code>语句提取出来.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func anyCommons&#60;T: Sequence, U: Sequence&#62;(lhs: T, rhs: U) -&#62; Bool&#10;    where T.Element: Equatable,T.Element == U.Element&#10;&#123;&#10;    print(&#34;here&#34;)&#10;    return true;&#10;    &#10;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="结果未使用警告的方法">结果未使用警告的方法</h3><p>对于一个没有使用的函数返回值(或者自定义的变量值),编译器都会给你一个警告.因为既然你认为有返回值, 而你却没有使用.这可能就是你忘记了.这种操作可能会造成你编码的 bug</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func plusOne(_ a : Int) -&#62;Int&#123;&#10;         print(a)&#10;         return a+1&#10;     &#125;&#10;     &#10;     plusOne(3) //&#24471;&#21040;&#35686;&#21578; Result of call to &#39;plusOne&#39; is unused</span><br></pre></td></tr></table></figure>
<p>但是一些情况下.我们确实不需要用到这个返回值,而且仅仅是为了函数的一个副作用( side effect) 而去调用函数. 例如,上面代码中的<code>print(a)</code>.这就是我调用函数的目的.<br>为了消除警告,可以使用如下方式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;func plusOne(_ a : Int) -&#62;Int&#123;&#10;    print(a)&#10;    return a+1&#10;&#125;&#10;&#10;_ =  plusOne(3)</span><br></pre></td></tr></table></figure>
<p>或者使用标记 <code>@discardableResult</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@discardableResult&#10;func plusOne(_ a : Int) -&#62;Int&#123;&#10;    print(a)&#10;    return a+1&#10;&#125;&#10;&#10;plusOne(3)</span><br></pre></td></tr></table></figure>
<h3 id="索引集合">索引集合</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let collection = [&#34;a&#34;,&#34;b&#34;,&#34;c&#34;,&#34;d&#34;]&#10;&#10;var i = collection.startIndex</span><br></pre></td></tr></table></figure>
<p>在 Swift 2.2 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swift 2 : var next = i.successor()</span><br></pre></td></tr></table></figure>
<p>在 Swift 3.0 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var next = collection.index(after: 2)</span><br></pre></td></tr></table></figure>
<h3 id="浮点型和数值型">浮点型和数值型</h3><ul>
<li>Float,Double,Float80 和 CGFloat统一使用新的浮点协议( Floating Point Protocol )</li>
<li>提供 IEEE-754 相关的属性和方法 (IEEE 754 标准是IEEE二进位浮点数算术标准（IEEE Standard for Floating-Point Arithmetic）的标准编号  ，等同于国际标准ISO/IEC/IEEE 60559[2])</li>
<li>允许在所有的浮点类型上使用算法泛型(水平有限,原文是:permits algrithms to be gerneric over all floating point types)</li>
</ul>
<p>用 PI 来举个例子:<br>Swift 2.2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let v = 2 * Float(M_PI)</span><br></pre></td></tr></table></figure>
<p>而在 Swift3.0中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let v = 2 * Float.pi</span><br></pre></td></tr></table></figure>
<p>如果第一个操作数是浮点数,还可以这样写:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let anotherV = 2.0 * .pi / 180</span><br></pre></td></tr></table></figure>
<h3 id="隐式解包可选">隐式解包可选</h3><p>在 Swift2.2中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func f(value: Int!)&#123;&#10;    let x = value + 1 // x &#26159; Int &#31867;&#22411; - &#24378;&#21046;&#35299;&#21253;&#10;    let y = value     // y &#26159; Int!&#10;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>在 Swift 3.0 中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func f(value: Int!)&#123;&#10;    let x = value + 1 // x &#26159; Int &#31867;&#22411; - &#24378;&#21046;&#35299;&#21253;&#10;    let y = value     // y &#26159; Int?&#10;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>具体参考:<br><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0054-abolish-iuo.md" target="_blank" rel="external">SE-0054</a></p>
<h3 id="一些细节的增强">一些细节的增强</h3><ul>
<li>当前文件访问级别,新增的权限控制关键字 <code>fileprivate</code> <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0025-scoped-access-level.md" target="_blank" rel="external">SE-0025</a></li>
<li><code>case</code>中的标签可以使用多种模式 <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0043-declare-variables-in-case-labels-with-multiple-patterns.md" target="_blank" rel="external">SE-0043</a></li>
<li>泛型别名 <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0048-generic-typealias.md" target="_blank" rel="external">SE-0048</a></li>
<li>引用Objective-C 的 key-paths <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0062-objc-keypaths.md" target="_blank" rel="external">SE-0062</a></li>
<li>引用 Objective-C中属性的 getter 和 setter <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0064-property-selectors.md" target="_blank" rel="external">SE-0064</a></li>
<li>协议和协议拓展的别名 <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0092-typealiases-in-protocols.md" target="_blank" rel="external">SE-0092</a><h3 id="移除的功能">移除的功能</h3></li>
</ul>
<ol>
<li>函数柯里化<a href="http://www.cocoachina.com/ios/20141110/10166.html" target="_blank" rel="external">Currying介绍</a></li>
<li>函数参数中的 <code>var</code> <a href="http://www.swiftcafe.io/2016/05/05/swift3-var/?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">详细介绍</a></li>
<li>去掉 <code>++</code> 和 <code>--</code> 操作符</li>
<li>C 风格的for循环</li>
<li>通过元组的形式传递函数参数列表 .<a href="http://www.paulrobinson.net/function-parameters-are-tuples-in-swift/" target="_blank" rel="external">详细介绍</a></li>
</ol>
<p>对第5条做一个说明:<br>在 swift 2.2 中,我们可以:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let param = (20,&#34;kenny&#34;,&#34;male&#34;)&#10;&#10;func personInfo(age: Int ,_ name: String ,_ gender: String)&#123;&#10;&#10;&#125;&#10;&#10;personInfo(param)&#10;&#10;//&#20063;&#21487;&#20197;&#19981;&#30465;&#30053;&#26631;&#31614;&#10;&#10;let param = (age:20, name:&#34;kenny&#34;, gender:&#34;male&#34;)&#10;&#10;func personInfo(age age: Int , name: String , gender: String)&#123;&#10;&#10;&#125;&#10;&#10;personInfo(param)</span><br></pre></td></tr></table></figure>
<p>这个语法在 Swift3.0中被去掉了.原因是这么传递,可能会和有一个元组类型参数的函数混淆.</p>
<p>参考 : WWDC 2016 Session 402 What’s new in Swift</p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Swift/">Swift</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Swift/">Swift</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>

<!-- 多说评论框 start -->
  <div class="ds-thread" data-thread-key="2016/06/15/Swift/Swift3-新特性/" data-title="Swift3 新特性 " data-url="http://yoursite.com/2016/06/15/Swift/Swift3-新特性/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"guiqingblog"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end -->

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/React-Native/">React Native</a><small>1</small></li>
  
    <li><a href="/categories/ReactiveCocoa/">ReactiveCocoa</a><small>3</small></li>
  
    <li><a href="/categories/Swift/">Swift</a><small>2</small></li>
  
    <li><a href="/categories/Swift进阶/">Swift进阶</a><small>4</small></li>
  
    <li><a href="/categories/UI相关/">UI相关</a><small>1</small></li>
  
    <li><a href="/categories/iOS-Tips/">iOS Tips</a><small>17</small></li>
  
    <li><a href="/categories/主页维护记录/">主页维护记录</a><small>4</small></li>
  
    <li><a href="/categories/其他技术/">其他技术</a><small>8</small></li>
  
    <li><a href="/categories/利用Runtime实现自依赖按钮/">利用Runtime实现自依赖按钮</a><small>1</small></li>
  
    <li><a href="/categories/开发环境相关/">开发环境相关</a><small>5</small></li>
  
    <li><a href="/categories/悟/">悟</a><small>1</small></li>
  
    <li><a href="/categories/环境、配置相关/">环境、配置相关</a><small>5</small></li>
  
    <li><a href="/categories/视频相关/">视频相关</a><small>1</small></li>
  
    <li><a href="/categories/重构、模式、架构/">重构、模式、架构</a><small>10</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Clang-Format/">Clang Format</a><small>1</small></li>
  
    <li><a href="/tags/React-Native/">React Native</a><small>1</small></li>
  
    <li><a href="/tags/ReactiveCocoa/">ReactiveCocoa</a><small>3</small></li>
  
    <li><a href="/tags/Swift/">Swift</a><small>2</small></li>
  
    <li><a href="/tags/Swift-进阶/">Swift 进阶</a><small>1</small></li>
  
    <li><a href="/tags/Swift进阶/">Swift进阶</a><small>1</small></li>
  
    <li><a href="/tags/Swift进阶-variable-with-a-setter-must-also-have-a-getter/">Swift进阶 variable with a setter must also have a getter</a><small>1</small></li>
  
    <li><a href="/tags/UI相关/">UI相关</a><small>1</small></li>
  
    <li><a href="/tags/iOS-Tips/">iOS Tips</a><small>4</small></li>
  
    <li><a href="/tags/主页维护记录/">主页维护记录</a><small>2</small></li>
  
    <li><a href="/tags/其他技术/">其他技术</a><small>4</small></li>
  
    <li><a href="/tags/利用Runtime实现自依赖按钮/">利用Runtime实现自依赖按钮</a><small>1</small></li>
  
    <li><a href="/tags/开发环境相关/">开发环境相关</a><small>3</small></li>
  
    <li><a href="/tags/悟/">悟</a><small>1</small></li>
  
    <li><a href="/tags/测试小样/">测试小样</a><small>1</small></li>
  
    <li><a href="/tags/环境、配置相关/">环境、配置相关</a><small>3</small></li>
  
    <li><a href="/tags/视频相关/">视频相关</a><small>1</small></li>
  
    <li><a href="/tags/设计模式/">设计模式</a><small>1</small></li>
  
    <li><a href="/tags/重构、模式、架构/">重构、模式、架构</a><small>5</small></li>
  
    <li><a href="/tags/问题解决和思考/">问题解决和思考</a><small>4</small></li>
  
    <li><a href="/tags/高效OC编程/">高效OC编程</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 桂庆
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>